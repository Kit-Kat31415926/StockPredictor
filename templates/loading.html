<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link
			rel="stylesheet"
			href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css"
			integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
			crossorigin="anonymous"
		/>
		<link rel="stylesheet" href="../static/css/style.css" />
		<title>Stock Predictor</title>
	</head>
	<body>
        <center>
            <br />
            <br />
            <br />
            <h1>Loading...</h1>
            <h3>Please do not refresh or exit the page</h3>
            <br />
            <p id="updated-text"></p>
        </center>
	</body>
    <script>
        /* Send database update request to server on load */
        const updateDatabase = async () => {
            const fetcher = await fetch('/update-database');
            const data = await fetcher.json();
            window.location.href = "{{ url_for('home') }}";
            return data;
        }

        // window.addEventListener('load', () => {
        //     await fetch('/update-database')
        //     .then(() => {
        //         // Redirect after updating database
        //         alert();
        //         window.location.href = "{{ url_for('home') }}";
        //     })
        //     .catch(error => {
        //         console.log(error);
        //     });
        // });

        window.addEventListener('load', () => {

            updateDatabase()
            setTimeout(() => {
                document.getElementById('updated-text').innerHTML = "This might take a while"
            }, 5000);
        });
    </script>
</html>
